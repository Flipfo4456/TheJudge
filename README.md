# Historical Court: Multi-Agent System

โปรเจกต์นี้คือระบบ Multi-Agent ที่ออกแบบมาเพื่อทำการค้นคว้าและวิเคราะห์ข้อมูลเกี่ยวกับบุคคลหรือเหตุการณ์ในประวัติศาสตร์อย่างเป็นกลาง โดยจำลองกระบวนการในชั้นศาลเพื่อหาข้อเท็จจริงทั้งในด้านบวกและด้านลบ ก่อนจะสรุปออกมาเป็นรายงานฉบับสมบูรณ์

## โครงสร้าง Workflow

ระบบทำงานแบบลำดับขั้น (Sequential) โดยมี Agent หลักที่ควบคุมการทำงานทั้งหมดและส่งต่อไปยัง Agent ย่อย ๆ ตามลำดับดังนี้:

1.  **Root Agent (Bailiff):** ทำหน้าที่เป็นตัวกลางเริ่มต้นกระบวนการทั้งหมด โดยจะสอบถามหัวข้อ (Topic) ที่ผู้ใช้ต้องการสืบสวนจากนั้นจะบันทึกหัวข้อลงใน State และส่งต่อให้ `court_process` เริ่มการพิจารณาคดี

2.  **Court Process (SequentialAgent):** เป็น Agent ที่ควบคุมกระบวนการหลักให้เกิดขึ้นตามลำดับ โดยจะเรียก `trial_court` เพื่อเริ่มการสืบสวน และเมื่อกระบวนการสืบสวนสิ้นสุด จะเรียก `verdict_writer` เพื่อเขียนรายงานสรุป

3.  **Trial Court (LoopAgent):** เป็นกระบวนการสืบสวนและตัดสินใจ ซึ่งจะทำงานวนซ้ำ (Loop) จนกว่าจะได้ข้อมูลที่สมดุลและเพียงพอ (สูงสุด 5 รอบ) ประกอบด้วย:
    *   **Investigators (ParallelAgent):** ในขั้นตอนนี้ Agent 2 ตัวจะทำงานพร้อมกัน (Parallel) เพื่อรวบรวมข้อมูล:
        *   **Admirer:** ค้นหาข้อมูลด้านบวก, ความสำเร็จ และข้อดีของหัวข้อนั้น ๆ
        *   **Critic:** ค้นหาข้อมูลด้านลบ, ข้อโต้เถียง และความล้มเหลวของหัวข้อนั้น ๆ
    *   **Judge:** ประเมินข้อมูลที่ `Admirer` และ `Critic` รวบรวมมา หากข้อมูลยังไม่สมดุลจะสั่งให้ทำการค้นคว้าเพิ่มเติม แต่ถ้าข้อมูลเพียงพอแล้วจะสั่งให้ `exit_loop` เพื่อจบกระบวนการสืบสวน

4.  **Verdict Writer:** Agent สุดท้ายที่จะถูกเรียกหลังจบกระบวนการ `trial_court` ทำหน้าที่รวบรวมข้อมูลด้านบวกและลบทั้งหมดมาเขียนเป็นรายงานที่เป็นกลาง (Neutral Report) จากนั้นจะบันทึกรายงานเป็นไฟล์ `.txt`

## รายละเอียดของ Agents

### 1. Root Agent (`root`)
*   **บทบาท:** นายประกัน (Bailiff)
*   **หน้าที่:** รับหัวข้อจากผู้ใช้และเริ่มต้นกระบวนการพิจารณาคดี
*   **Tools:**
    *   `set_state`: บันทึกหัวข้อที่ผู้ใช้ป้อนเข้ามาใน State ของระบบ
*   **Sub-agents:** `court_process`

### 2. Investigators (`investigators`)
เป็น `ParallelAgent` ที่ประกอบด้วย Agent ย่อย 2 ตัวที่ทำงานขนานกัน

#### 2.1. Admirer (`admirer`)
*   **บทบาท:** ผู้ชื่นชม
*   **หน้าที่:** ค้นหาข้อมูลด้านบวกของหัวข้อ
*   **Tools:**
    *   `wiki_research`: ค้นหาข้อมูลจาก Wikipedia
    *   `set_state`: บันทึกข้อมูลที่ค้นพบในช่อง `pos_data`

#### 2.2. Critic (`critic`)
*   **บทบาท:** ผู้วิจารณ์
*   **หน้าที่:** ค้นหาข้อมูลด้านลบของหัวข้อ
*   **Tools:**
    *   `wiki_research`: ค้นหาข้อมูลจาก Wikipedia
    *   `set_state`: บันทึกข้อมูลที่ค้นพบในช่อง `neg_data`

### 3. Judge (`judge`)
*   **บทบาท:** ผู้พิพากษา
*   **หน้าที่:** ประเมินข้อมูลจาก `Admirer` และ `Critic` เพื่อตัดสินใจว่าจะค้นหาข้อมูลต่อหรือยุติการสืบสวน
*   **Tools:**
    *   `exit_loop`: ถูกเรียกเมื่อข้อมูลมีความสมดุลและเพียงพอแล้ว เพื่อจบการทำงานของ `LoopAgent`

### 4. Verdict Writer (`verdict_writer`)
*   **บทบาท:** ผู้เขียนคำตัดสิน
*   **หน้าที่:** เขียนรายงานสรุปที่เป็นกลางจากข้อมูลทั้งหมด และบันทึกเป็นไฟล์
*   **Tools:**
    *   `write_file`: บันทึกเนื้อหารายงานลงในไฟล์ `.txt`

## Tools ที่ใช้

*   `wiki_research(query: str)`: ค้นหาบทสรุปจาก Wikipedia ตาม `query` ที่ระบุ
*   `exit_loop()`: ส่งสัญญาณเพื่อแจ้งให้ `LoopAgent` หยุดการทำงานวนซ้ำ
*   `set_state(tool_context: ToolContext, field: str, response: str)`: บันทึกหรืออัปเดตข้อมูลลงใน State ของเซสชัน
*   `write_file(tool_context: ToolContext, filename: str, content: str)`: เขียน `content` ที่กำหนดลงในไฟล์ชื่อ `filename`
